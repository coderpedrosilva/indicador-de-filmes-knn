<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Mini Streaming Inteligente</title>
<style>
body{margin:0;font-family:Arial;background:#0f0f0f;color:white}
h1{text-align:center;margin:20px 0}
.row{margin:20px}
.row h2{margin:10px 0}
.row-container{display:flex;gap:16px;overflow-x:auto;padding-bottom:10px}
.card{min-width:160px;background:#1c1c1c;border-radius:12px;padding:12px;text-align:center}
.stars span{font-size:22px;cursor:pointer;color:#555}
.stars span.active{color:gold}
button{margin:20px auto;display:block;padding:14px 30px;border:none;border-radius:10px;background:#e50914;color:white;font-size:16px;cursor:pointer}
.reco{background:#141414;padding:20px}
</style>
</head>

<body>

<h1>ðŸŽ¬ Mini Streaming Inteligente</h1>

<div id="catalog"></div>

<button onclick="discover()">Descobrir novos filmes</button>

<div class="reco">
<h2>Recomendado para vocÃª</h2>
<div class="row-container" id="recs"></div>
</div>

<script>
const catalog = {
"AÃ§Ã£o":["John Wick","Mad Max: Fury Road","Velozes e Furiosos","MissÃ£o ImpossÃ­vel","Duro de Matar","Gladiador","Matrix"],
"Terror":["InvocaÃ§Ã£o do Mal","It: A Coisa","O Exorcista","Atividade Paranormal","HereditÃ¡rio","Jogos Mortais","A Bruxa"],
"ComÃ©dia":["As Branquelas","Se Beber NÃ£o Case","Todo Mundo em PÃ¢nico","Minha MÃ£e Ã© uma PeÃ§a","American Pie","Click","Gente Grande"],
"Drama":["Titanic","DiÃ¡rio de uma PaixÃ£o","Forrest Gump","Ã€ Procura da Felicidade","A Espera de um Milagre","O Pianista","Clube da Luta"],
"FicÃ§Ã£o":["Interestelar","Blade Runner","Ex Machina","Avatar","Gravidade","Distrito 9","Duna"],
"AnimaÃ§Ã£o":["Toy Story","Shrek","Procurando Nemo","Up","Divertida Mente","Os IncrÃ­veis","Kung Fu Panda"]
};

function renderCatalog(){
 const area=document.getElementById("catalog");
 Object.keys(catalog).forEach(cat=>{
  const row=document.createElement("div");
  row.className="row";
  row.innerHTML=`<h2>${cat}</h2><div class="row-container"></div>`;
  const container=row.querySelector(".row-container");

  catalog[cat].forEach(m=>{
   const card=document.createElement("div");
   card.className="card";
   card.innerHTML=`<h3>${m}</h3><div class="stars">${[1,2,3,4,5].map(n=>`<span onclick="rate('${m}',${n},this)">â˜…</span>`).join("")}</div>`;
   container.appendChild(card);
  });

  area.appendChild(row);
 });
}

function rate(filme,nota,el){
 fetch("/api/rate",{method:"POST",headers:{'Content-Type':'application/json'},body:JSON.stringify({filme,nota})});
 const stars=el.parentNode.querySelectorAll("span");
 stars.forEach((s,i)=>s.classList.toggle("active",i<nota));
}

async function discover(){
 const r=await fetch("/api/recommend");
 const data=await r.json();
 const area=document.getElementById("recs");
 area.innerHTML="";
 data.forEach(f=>{
  const card=document.createElement("div");
  card.className="card";
  card.innerHTML=`<h3>${f[0]}</h3><p>${f[1]}</p>`;
  area.appendChild(card);
 });
}

renderCatalog();
</script>
</body>
</html>
